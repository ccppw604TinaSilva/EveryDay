# 初探富文本之编辑器引擎
在前文中我们介绍了富文本的基础概念，以及富文本的基本发展历程，那么在本文中将会介绍当前主流开源的富文本编辑器引擎。当前使用最广泛的富文本编辑器是`L1`的富文本编辑器，其能满足绝大部份使用场景，由此也诞生了非常多优秀的开源富文本引擎，这其中有仅提供引擎的编辑器例如`Slate.js`，也有提供了部分开箱即用的功能的例如`Quill.js`，也有基于这些引擎二次开发的例如`Plate.js`。这么多的引擎在选择的时候还是需要对比一下的，适合的才是最好的。

## Slate.js
`slate`是一个仅仅提供引擎的富文本`core`，简单来说他本身并不提供各种富文本编辑功能，所有的富文本功能都需要自己来通过其提供的`API`来实现，甚至他的插件机制也需要通过自己来拓展，所以使用`slate`来构建富文本编辑器的话可定制度相当高。`slate`的文档虽然不是特别详细，但是他的示例是非常丰富的，在文档中也提供了一个演练作为上手的基础，对于新手还是比较友好的。话说回来如果只提供一个引擎的话，谁也不知道应该怎么用哈哈。

在`slate`的文档中有对于框架的设计原则上的描述，搬运一下：
* 插件是一等公民，`slate`最重要的部分就是插件是一等公民实体，这意味着你可以完全定制编辑体验，去建立像`Medium`或是`Dropbox`这样复杂的编辑器，而不必对库的预设作斗争。
* 精简的`schema`核心，`slate`的核心逻辑对你编辑的数据结构进行的预设非常少，这意味着当你构建复杂用例时，不会被任何的预制内容所阻碍。
* 嵌套文档模型，`slate`文档所使用的模型是一个嵌套的，递归的树，就像`DOM`一样，这意味着对于高级用例来说，构建像表格或是嵌套引用这样复杂的组件是可能的，当然你也可以使用单一层次的结构来保持简单性。
* 与`DOM`相同，`slate`的数据模型基于`DOM`，文档是一个嵌套的树，其使用文本选区`selections`和范围`ranges`，并且公开所有的标准事件处理函数，这意味着像是表格或者是嵌套引用这样的高级特性是可能的，几乎所有你在`DOM`中可以做到的事情，都可以在`slate`中做到。
* 直观的指令，`slate`文档执行命令`commands`来进行编辑，它被设计为高级并且非常直观地进行编辑和阅读，以便定制功能尽可能地具有表现力，这大大的提高了你理解代码的能力。
* 可协作的数据模型，`slate`使用的数据模型特别是操作如何应用到文档上，被设计为允许协同编辑在最顶层，所以如果你决定要实现协同编辑，不必去考虑彻底重构。
* 明确的核心划分，使用插件优先的结构和精简核心，使得核心和定制的边界非常清晰，这意味着核心的编辑体验不会被各种边缘情况所困扰。

### 优点
* 可定制化程度非常高，几乎所有富文本表现层的功能都需要自行实现。
* 非常轻量，本体只有一个内核，需要什么就做什么功能，体积可控。
* 在架构设计时就针对协同提供了`OP`化的差量变更操作，

### 不足
* 依旧处于`Beta`阶段，可能会有重大`API`变化，例如`0.50`版本就是全新重构的。
* 虽然有协同的设计，但没有基于`OP`操作的`OT`算法或`CRDT`算法的直接支持。
* 仅有内核的架构同样也是不足，所有的功能都需要自行实现，成本比较高。

### 链接
* `slate`官方文档`https://docs.slatejs.org/`。
* `slate`官方示例`https://www.slatejs.org/examples/richtext`。
* 个人基于`slate`实现的富文本编辑器`https://github.com/WindrunnerMax/DocEditor`。
* 基于`slate`的开箱即用的编辑器`https://plate.udecode.io/docs/playground`。
* `slate`协同的`OT`算法参考`https://github.com/solidoc/slate-ot`。
* `slate`协同的`CRDT`算法参考`https://github.com/cudr/slate-collaborative`。
* 关于`slate`非常不错的文章`https://github.com/yoyoyohamapi/book-slate-editor-design`。



## 每日一题

```
https://github.com/WindrunnerMax/EveryDay
```

## 参考

```
https://zhuanlan.zhihu.com/p/425265438
https://jkrsp.com/slate-js-vs-draft-js/
https://www.zhihu.com/question/449541344
https://juejin.cn/post/7034480408888770567
https://blog.logrocket.com/what-is-slate-js-replace-quill-draft-js/
```
